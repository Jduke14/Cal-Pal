{% extends 'base.html.twig' %}

{% block title %}Cal-Pal Homepage{% endblock %}

{% block headblock %} 
<script 
	src="https://code.jquery.com/jquery-2.2.4.min.js"
  	integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  	crossorigin="anonymous"></script>
<script src="{{ asset('js/moment.js') }}"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.8.2/fullcalendar.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.8.2/fullcalendar.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.8.2/fullcalendar.print.css" media="print" rel="stylesheet">

<script>
  $(document).ready(function() {

      // page is now ready, initialize the calendar...

      $('#calendar').fullCalendar({
        // put your options and callbacks here

        defaultView: 'agendaWeek',

        minTime: '07:00:00',
        maxTime: '18:30:00',
        height: 697,

        header: {
          center: 'title'
        },

        buttonIcons: {
          prev: 'left-single-arrow',
          next: 'right-single-arrow'
        },

        events:
          function(start, end, timezone, callback) {
                //$('body').append('<img id="calendar-spinner" src="{{ asset("images/loaders/loader10.gif") }}"></img>');
                var url = '{{ path('calendarEvents') }}';
                $.ajax(url, {
                    type: 'GET',
                    timeout: 30*1000,
                    dataType: 'json',
                    data: {
                        start: start.unix(),
                        end: end.unix(),
                        _: Math.round(new Date().getTime() / 1000) // prevents browswer caching
                    },
                    success: function(events) {
                      callback(events);
                    }
                })
          }
      })
  })
</script> {% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

 <div class="column2">
    <h2>Appointment Calendar</h2>
        <div id='calendar'></div>
            <p class="cal"></p>
        </div>
{% endblock %}
